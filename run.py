import os import sys import logging import argparse import subprocess import platform # Configure logging logging.basicConfig( level=logging.INFO, format='%(asctime)s - %(name)s - %(levelname)s - %(message)s', handlers=[ logging.FileHandler("run_log.log"), logging.StreamHandler() ] ) logger = logging.getLogger(__name__) def run_test(): """Run the test script to verify strategies""" logger.info("Running test script...") try: import test_bot test_bot.main() logger.info("Test completed successfully") return True except Exception as e: logger.error(f"Test failed: {e}") return False def run_bot(): """Run the main bot""" logger.info("Starting the main bot...") try: import bot bot.main() except Exception as e: logger.error(f"Bot failed: {e}") def check_python_installed(): """Check if Python is installed and install it if not""" try: # Try to run Python and get its version result = subprocess.run([sys.executable, '--version'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True) if result.returncode == 0: logger.info(f"Python is installed: {result.stdout.strip()}") return True else: logger.error("Python check failed") return False except Exception as e: logger.error(f"Error checking Python: {e}") return False def check_dependencies(): """Check if required packages are installed""" try: # Try to import required packages import requests import telebot from dotenv import load_dotenv logger.info("All required packages are installed") return True except ImportError as e: logger.error(f"Missing dependency: {e}") logger.info("Installing required packages...") try: subprocess.run([sys.executable, '-m', 'pip', 'install', '-r', 'requirements.txt'], check=True) logger.info("Dependencies installed successfully") return True except Exception as e: logger.error(f"Failed to install dependencies: {e}") print("\n===== INSTALLATION INSTRUCTIONS =====\n") print("Python or required packages are not installed properly.") print("Please follow these steps to install them:\n") print("1. Install Python from https://www.python.org/downloads/") print("2. Open a command prompt and run:") print(" pip install -r requirements.txt") print("\nAfter installation, try running this script again.") return False def main(): parser = argparse.ArgumentParser(description='Run Trae AI Agent for BDG K3 Game Prediction') parser.add_argument('--test', action='store_true', help='Run test script only') parser.add_argument('--skip-test', action='store_true', help='Skip test and run main bot directly') args = parser.parse_args() # Check if Python is installed if not check_python_installed(): sys.exit(1) # Check if dependencies are installed if not check_dependencies(): sys.exit(1) if args.test: run_test() elif args.skip_test: run_bot() else: # Default: run test first, then main bot if test passes if run_test(): run_bot() else: logger.error("Test failed, not starting the main bot") sys.exit(1) if __name__ == "__main__": main()
